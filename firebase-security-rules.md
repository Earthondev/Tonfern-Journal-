# üîí Firebase Security Rules ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Tonfern Journal

## üìã Database Rules (Realtime Database)

‡πÉ‡∏™‡πà UID ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ü‡∏¥‡∏£‡πå‡∏ô‡πÅ‡∏ó‡∏ô‡∏Ñ‡πà‡∏≤ `FERN_UID_HERE` ‡πÉ‡∏ô Firebase Console

```json
{
  "rules": {
    ".read": true, 
    ".write": "auth != null && auth.uid === 'FERN_UID_HERE'",

    "pages": {
      ".read": true,
      "$pageId": {
        ".write": "auth != null && auth.uid === 'FERN_UID_HERE'"
      }
    },

    "toc": {
      ".read": true,
      ".write": "auth != null && auth.uid === 'FERN_UID_HERE'"
    },

    "settings": {
      ".read": true,
      ".write": "auth != null && auth.uid === 'FERN_UID_HERE'"
    }
  }
}
```

## üóÇÔ∏è Storage Rules

‡πÉ‡∏™‡πà UID ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ü‡∏¥‡∏£‡πå‡∏ô‡πÅ‡∏ó‡∏ô‡∏Ñ‡πà‡∏≤ `FERN_UID_HERE` ‡πÉ‡∏ô Firebase Console

```javascript
rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô
    match /uploads/{userId}/{allPaths=**} {
      allow read: if true;

      // ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏•‡∏ö ‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏ü‡∏¥‡∏£‡πå‡∏ô ‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ï‡πâ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
      allow write: if request.auth != null
                   && request.auth.uid == userId
                   && userId == 'FERN_UID_HERE'
                   // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏ç‡πà/‡∏ä‡∏ô‡∏¥‡∏î‡πÅ‡∏õ‡∏•‡∏Å ‡πÜ (‡∏õ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ)
                   && request.resource.size < 15 * 1024 * 1024
                   && request.resource.contentType.matches('image/.*|video/.*');
    }
  }
}
```

## üöÄ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤

### 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ "‡πÄ‡∏ü‡∏¥‡∏£‡πå‡∏ô" ‡πÉ‡∏ô Firebase Auth
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Firebase Console > Authentication > Users
2. ‡∏Ñ‡∏•‡∏¥‡∏Å "Add User"
3. ‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
4. ‡∏Å‡πä‡∏≠‡∏õ UID ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ

### 2. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Database Rules
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Firebase Console > Realtime Database > Rules
2. ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà `FERN_UID_HERE` ‡∏î‡πâ‡∏ß‡∏¢ UID ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ü‡∏¥‡∏£‡πå‡∏ô
3. ‡∏Ñ‡∏•‡∏¥‡∏Å "Publish"

### 3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Storage Rules
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Firebase Console > Storage > Rules
2. ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà `FERN_UID_HERE` ‡∏î‡πâ‡∏ß‡∏¢ UID ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ü‡∏¥‡∏£‡πå‡∏ô
3. ‡∏Ñ‡∏•‡∏¥‡∏Å "Publish"

### 4. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÑ‡∏ü‡∏•‡πå config
1. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `js/firebase-config.js` ‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á
2. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `admin/admin.js` ‡πÇ‡∏î‡∏¢‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô `FERN_UID_HERE` ‡πÄ‡∏õ‡πá‡∏ô UID ‡∏à‡∏£‡∏¥‡∏á

## üìä ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥

```
pages/
  0001: { 
    title: "Cover",  
    type: "image", 
    src: "https://.../uploads/FERN_UID/cover.jpg",
    order: 1,
    createdAt: 1703123456789,
    updatedAt: 1703123456789
  }
  0002: { 
    title: "‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å", 
    type: "text",  
    content: "...",
    note: "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å",
    order: 2,
    createdAt: 1703123456789,
    updatedAt: 1703123456789
  }
  0003: { 
    title: "Vlog",   
    type: "video", 
    src: "https://.../uploads/FERN_UID/vlog.mp4",
    order: 3,
    createdAt: 1703123456789,
    updatedAt: 1703123456789
  }

toc/
  items: [
    { id: "0001", title: "Cover", order: 1 },
    { id: "0002", title: "‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å", order: 2 },
    { id: "0003", title: "Vlog", order: 3 }
  ]

settings/
  display: { 
    twoPageSpread: true, 
    pageFlipSound: true,
    enableNotes: true 
  }
```

## üîê ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á Security Rules

### Database Rules
- **‡∏≠‡πà‡∏≤‡∏ô**: ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ (public read)
- **‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô**: ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏ü‡∏¥‡∏£‡πå‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏î‡πâ
- **‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á**: ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô path ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î

### Storage Rules
- **‡∏≠‡πà‡∏≤‡∏ô**: ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏î‡πâ
- **‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô**: ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏ü‡∏¥‡∏£‡πå‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏î‡πâ
- **Path**: ‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ï‡πâ `/uploads/{FERN_UID}/...`
- **‡∏Ç‡∏ô‡∏≤‡∏î**: ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 15MB
- **‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó**: ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠

## ‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á

1. **UID ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô**: UID ‡πÉ‡∏ô Rules ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö UID ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á
2. **Path ‡∏ï‡πâ‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á**: ‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ï‡πâ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
3. **‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå**: ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå
4. **‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÑ‡∏ü‡∏•‡πå**: ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

## üß™ ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô (Public)
- ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
- ‡∏Ñ‡∏ß‡∏£‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏õ‡∏Å‡∏ï‡∏¥

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô (Admin Only)
- ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ü‡∏¥‡∏£‡πå‡∏ô
- ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ
- ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏≠‡∏∑‡πà‡∏ô
- ‡∏Ñ‡∏ß‡∏£‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Storage
- ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ï‡πâ `/uploads/{FERN_UID}/...`
- ‡∏Ñ‡∏ß‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏î‡πâ
- ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ï‡πâ path ‡∏≠‡∏∑‡πà‡∏ô
- ‡∏Ñ‡∏ß‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ
